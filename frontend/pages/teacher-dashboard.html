<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ClicaEd - Tableau de bord Enseignant</title>
    <link rel="stylesheet" href="../css/main.css" />
    <link rel="stylesheet" href="../css/posts.css" />
    <link rel="icon" type="image/png" href="../assets/icon.png" />
    <!-- Font Awesome 6 -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
  </head>

  <body>
    <!-- Header -->
    <header class="header" id="header">
      <div class="header-brand">
        <button class="mobile-nav-toggle" type="button">
          <span class="sr-only">Ouvrir le menu</span>
          <i class="fa-solid fa-bars" aria-hidden="true"></i>
        </button>
        <a class="logo" id="profile-home-link" href="/pages/teacher-dashboard.html">
          <img src="../assets/logo.png" alt="Logo ClicaEd" />
          <span>ClicaEd</span>
        </a>
      </div>

      <div class="search-bar">
        <input
          id="search-input"
          type="text"
          placeholder="Rechercher un cours‚Ä¶"
          aria-label="Rechercher un cours"
        />
      </div>

      <div class="user-menu">
        <button
          class="action-button"
          id="btn-creer"
          name="creer"
          title="Cr√©er"
          data-open="publications"
        >
          <i class="fa-solid fa-plus"></i> Cr√©er
        </button>
        <a class="user-avatar" href="/pages/profile.html" title="Voir mon profil">U</a>
      </div>
    </header>

    <!-- Main Container -->
    <div class="main-container" id="main-container">
      <!-- Left Sidebar -->
      <nav class="left-sidebar" id="left-sidebar">
        <a href="#" class="sidebar-item" id="nav-accueil" title="Accueil">
          <span class="sidebar-icon"><i class="fa-solid fa-house"></i></span>
          Accueil
        </a>

        <div class="sidebar-section">
          <div class="sidebar-header">Gestion des cours</div>
          <a href="#" class="sidebar-item active" id="nav-cours" title="Mes cours">
            <span class="sidebar-icon"><i class="fa-solid fa-book"></i></span>
            Mes Cours
          </a>
        </div>

        <div class="sidebar-section">
          <div class="sidebar-header">Communication</div>
          <a
            href="#"
            class="sidebar-item"
            id="nav-publications"
            title="Publications"
          >
            <span class="sidebar-icon"><i class="fa-solid fa-images"></i></span>
            Publications
          </a>
        </div>
      </nav>

      <!-- Centered Content Wrapper -->
      <div class="centered-content" id="centered-content">
        <div class="content-container" id="content-container">
          <main class="content-area" id="content-area">

            <!-- Accueil -->
            <section id="accueil" class="content-section">
              <h2>üè† Accueil</h2>
              <p>Bienvenue sur votre tableau de bord enseignant.</p>
              <p>Utilisez le menu pour g√©rer vos cours.</p>
            </section>

            <!-- Mes Cours (Reddit-inspired) -->
            <section id="cours" class="content-section active">
              <header class="courses-header">
                <div class="left">
                  <h2>üìò Mes Cours</h2>
                  <div class="meta muted" id="courses-count">‚Äî</div>
                </div>

                <div class="right actions-wrap">
                  <div class="search-wrap">
                    <i class="fa-solid fa-magnifying-glass"></i>
                    <input id="course-search" type="search" placeholder="Rechercher un cours‚Ä¶" autocomplete="off" />
                  </div>

                  <div class="segmented small" role="tablist" aria-label="Filtre statut">
                    <button class="segmented-item active" data-filter="all" aria-selected="true">Tous</button>
                    <button class="segmented-item" data-filter="published" aria-selected="false">Publi√©s</button>
                    <button class="segmented-item" data-filter="draft" aria-selected="false">Brouillons</button>
                  </div>

                  <div class="select-wrap">
                    <i class="fa-solid fa-arrow-down-wide-short"></i>
                    <select id="course-sort">
                      <option value="updated_desc">Tri: Modifi√© ‚Üì</option>
                      <option value="updated_asc">Tri: Modifi√© ‚Üë</option>
                      <option value="title_asc">Titre A‚ÄìZ</option>
                      <option value="title_desc">Titre Z‚ÄìA</option>
                      <option value="students_desc">√âl√®ves ‚Üì</option>
                      <option value="students_asc">√âl√®ves ‚Üë</option>
                    </select>
                  </div>

                  <div class="view-toggle" title="Vue">
                    <button class="view-btn active" data-view="grid"><i class="fa-solid fa-grip"></i></button>
                    <button class="view-btn" data-view="list"><i class="fa-solid fa-list"></i></button>
                  </div>

                  <button class="action-button" id="btn-new-course">
                    <i class="fa-solid fa-plus"></i> Nouveau cours
                  </button>
                </div>
              </header>

              <div id="courses-container" class="course-grid">
                <!-- Skeletons (loading state) -->
                <div class="course-card skeleton"></div>
                <div class="course-card skeleton"></div>
                <div class="course-card skeleton"></div>
                <div class="course-card skeleton"></div>
              </div>

              <div id="courses-empty" class="empty-state hidden">
                <div class="empty-illustration">üì≠</div>
                <h3>Aucun cours</h3>
                <p class="muted">Cr√©ez votre premier cours pour commencer.</p>
                <button class="action-button" id="btn-empty-new">Cr√©er un cours</button>
              </div>

              <!-- Course Detail View -->
              <section id="course-detail" class="course-detail hidden" aria-live="polite">
                <div class="course-detail__hero">
                  <div class="course-detail__hero-top">
                    <button type="button" class="btn-secondary" id="course-detail-back">
                      <i class="fa-solid fa-arrow-left"></i>
                      Retour aux cours
                    </button>
                    <span class="course-detail__status" id="course-detail-status">‚Äî</span>
                  </div>

                  <div class="course-detail__hero-main">
                    <div class="course-detail__icon" aria-hidden="true">
                      <i class="fa-solid fa-folder"></i>
                    </div>
                    <div class="course-detail__meta">
                      <div class="course-detail__breadcrumb" id="course-detail-breadcrumb">‚Äî</div>
                      <h3 class="course-detail__title" id="course-detail-title">Titre du cours</h3>
                      <p class="course-detail__subtitle" id="course-detail-subtitle">‚Äî</p>
                    </div>
                    <div class="course-detail__search">
                      <i class="fa-solid fa-magnifying-glass"></i>
                      <input
                        type="search"
                        id="course-detail-search"
                        placeholder="Rechercher dans ce cours‚Ä¶"
                        autocomplete="off"
                      />
                    </div>
                  </div>

                </div>

                  <div class="course-detail__body">
                    <div id="course-detail-loading" class="course-detail__loading">
                      <div class="loader"></div>
                      <p>Chargement du cours‚Ä¶</p>
                    </div>

                  <div id="course-detail-content" class="course-detail__content hidden">
                    <section class="course-block">
                      <header class="course-block__header course-block__header--tight">
                        <div class="course-block__title-wrap">
                          <h4>Ressources</h4>
                          <span id="course-detail-resources-count" class="course-block__count">0</span>
                        </div>
                        <button class="btn-secondary course-block__action" id="course-detail-add-resource" disabled>
                          <i class="fa-solid fa-plus"></i> Ajouter une section
                        </button>
                      </header>
                      <div id="course-detail-resources" class="resource-grid"></div>
                      <div id="course-detail-resources-empty" class="course-block__empty hidden">
                        <p>Aucune ressource pour le moment.</p>
                      </div>
                    </section>

                  </div>

                  <div id="course-detail-error" class="course-detail__error hidden">
                    <p>Impossible de charger ce cours pour le moment.</p>
                  </div>
                </div>
              </section>

              <dialog id="section-dialog" class="course-dialog">
                <form id="section-form" class="course-form" autocomplete="off" enctype="multipart/form-data">
                  <div class="dialog-header">
                    <h3>Nouvelle section</h3>
                    <button type="button" class="icon-btn" id="section-dlg-close" title="Fermer">
                      <i class="fa-solid fa-xmark"></i>
                    </button>
                  </div>

                  <div class="form-grid">
                    <label class="field" style="grid-column: span 2;">
                      <span>Titre de la section *</span>
                      <input type="text" id="section-title" name="title" placeholder="ex: Chapitre 1 - Introduction" required />
                    </label>

                    <label class="field" style="grid-column: span 2;">
                      <span>Description</span>
                      <input type="text" id="section-description" name="description" placeholder="Optionnel" />
                    </label>

                    <label class="field" style="grid-column: span 2;">
                      <span>Titre du m√©dia</span>
                      <input type="text" id="section-media-title" name="resource_title" placeholder="Par d√©faut, reprend le titre de la section" />
                    </label>

                    <label class="field" style="grid-column: span 2;">
                      <span>Fichier (PDF, image ou vid√©o) *</span>
                      <input type="file" id="section-media" name="media" accept="application/pdf,image/*,video/*" required />
                    </label>
                    <p class="muted" style="grid-column: span 2; margin: 0; font-size: 0.85rem;">
                      Un seul fichier par section. Formats accept√©s&nbsp;: PDF, images ou vid√©os.
                    </p>
                  </div>

                  <div class="dialog-actions">
                    <button type="button" class="btn-secondary" id="section-dlg-cancel">Annuler</button>
                    <button type="submit" class="btn-primary" id="section-dlg-save">
                      <i class="fa-solid fa-floppy-disk"></i> Enregistrer
                    </button>
                  </div>
                </form>
              </dialog>

              <!-- Dialog: Create / Edit Course -->
              <dialog id="course-dialog" class="course-dialog">
                <form id="course-form" method="dialog" class="course-form" autocomplete="off">
                  <div class="dialog-header">
                    <h3 id="course-dialog-title">Nouveau cours</h3>
                    <button type="button" class="icon-btn" id="dlg-close" title="Fermer">
                      <i class="fa-solid fa-xmark"></i>
                    </button>
                  </div>

                  <div class="form-grid">
                    <label class="field">
                      <span>Titre du cours *</span>
                      <input type="text" id="cf-title" name="title" placeholder="ex: Math√©matiques - 2A" required />
                    </label>

                    <label class="field">
                      <span>Mati√®re *</span>
                      <select id="cf-subject" name="subject_id" required>
                        <option value="">‚Äî Choisir ‚Äî</option>
                      </select>
                    </label>

                    <label class="field">
                      <span>Classe *</span>
                      <select id="cf-class" name="class_id" required>
                        <option value="">‚Äî Choisir ‚Äî</option>
                      </select>
                    </label>

                    <label class="field">
                      <span>Statut</span>
                      <select id="cf-status" name="status">
                        <option value="draft">Brouillon</option>
                        <option value="published">Publi√©</option>
                      </select>
                    </label>
                  </div>

                  <div class="dialog-actions">
                    <button type="button" class="btn-secondary" id="dlg-cancel">Annuler</button>
                    <button type="submit" class="btn-primary" id="dlg-save">
                      <i class="fa-solid fa-floppy-disk"></i> Enregistrer
                    </button>
                  </div>
                </form>
              </dialog>
            </section>

            <section id="publications" class="content-section" hidden>
              <h2>üñº Publications</h2>

              <div
                id="post-composer-host"
                data-component="post-composer"
                data-src="../pages/student-post.html"
                data-selector="form.post-card"
                data-ready="false"
              ></div>

              <div id="feed" class="card" style="margin-top: 14px;">
                <div class="muted">Rien √† afficher pour le moment‚Ä¶</div>
              </div>
            </section>

          </main>
        </div>
      </div>
    </div>

    <!-- JS -->
    <script src="../js/notify.js" defer></script>
    <script src="../js/navbar.js"></script>
    <script src="../js/courses.js" defer></script>
    <script src="../js/student-app.js"></script>
    <script src="../js/posts.js"></script>
  </body>
</html>
